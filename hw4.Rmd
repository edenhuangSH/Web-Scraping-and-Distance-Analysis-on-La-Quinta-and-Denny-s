---
title: "Homework 4"
author: Faustine, Eden, Shaoji, Yumemichi
output: html_document
---
<br>

> "La Quinta is Spanish for next to Dennyâ€™s" - Mitch Hedberg

Our group scraped location data from La Quinta and Denny's websites to see if this joke has a kernal of truth in it. 

### Task 1 - Scraping La Quinta

### Task 2 - Scraping Denny's

### Task 3 - Distance Analysis

```{r}
library('dylyr')
library('maps')
library('datasets')
library('ggplot2')
library('geosphere')
load('data/lq.Rdata')
load('data/dennys.Rdata')

# Build data frames for La Quinta and Denny's that include state, lattitude and longitude
lqLoc = data.frame(State = hotels$state, 
                   Lattitude = as.numeric(hotels$lat), 
                   Longitude = as.numeric(hotels$long))
dennysLoc = data.frame(State = dennys$state, 
                   Lattitude = as.numeric(dennys$lat), 
                   Longitude = as.numeric(dennys$long))

#  Remove the denny's and La Quinta with no State, which means they are outside of US
lqLoc = lqLoc[!is.na(lqLoc$State),]
dennysLoc = dennysLoc[dennysLoc$State != "",]

# Re-order the data frame by state
lqLoc = lqLoc[order(lqLoc$State),]
dennysLoc = dennysLoc[order(dennysLoc$State),]

# Find the states where both Denny's and La Quinta exists
lq_states = unique(lqLoc$State)
dennys_states = unique(dennysLoc$State)
common_states = intersect(lq_states, dennys_states)

# Selecting Denny's and La Quita that exist in states having both of them
dennys_commonStates = dennysLoc[dennysLoc$State %in% common_states,]
lq_commonStates = lqLoc[lqLoc$State %in% common_states,]

# Plot Denny's and La Quinta on the map
# Make a new data frame that stores all La Quinta and Denny's information for ggplot
lq_melt = data.frame(Type = rep("La Quinta", nrow(lq_commonStates))) %>%
  cbind(lq_commonStates)
dennys_melt = data.frame(Type = rep("Denny's", nrow(dennys_commonStates))) %>%
  cbind(dennys_commonStates)
lq_dennys = rbind(lq_melt,dennys_melt)
lq_dennys$Type = as.factor(lq_dennys$Type)

# Create a data frame that stores information of all US states
world = map_data("world")
Alaska = world[world$subregion == "Alaska",] %>%
  .[!is.na(.$subregion),]
Alaska$region = Alaska$subregion
Alaska$subregion = rep(NA, nrow(Alaska))
all_states = rbind(map_data("state"), Alaska)

# Do the plot
ggplot() + 
  geom_polygon(data = all_states, aes(x=long, y=lat, group = group), colour="white", fill="blue") +
  xlim(-180, -60) + 
  geom_point(data = lq_dennys, aes(x=Longitude, y=Lattitude, group=Type, color=Type), cex = 0.6)

# Calculate the distance between each of the Denny's and La Quinta in the common_states

```

### Discussion 


